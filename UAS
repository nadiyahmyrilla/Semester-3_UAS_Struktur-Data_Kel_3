#include <stdio.h>
#include <conio.h>
#include <stdlib.h>
#include <string.h>

//===================DOUBLE LINKED LIST=============================
struct node {
    int id;                
    char judul[100];
    char artis[100];
    int durasi;             // Durasi Lagu (dalam detik)
    int tahunRilis;
    struct node *left;
    struct node *right;
};
typedef struct node node;

void tambahAwal(node **head);
void tambahData(node **head);
void tambahAkhir(node **head);
void hapusAwal(node **head);
void hapusData(node **head);
void hapusAkhir(node **head);
void totalData(node **head);
void totalValue(node **head);
void cariData(node **head);
void tranverse(node *head);
//==================================================================

//====================DATA UTAMA====================================
int main() {
	node *head = NULL;
	char pilih; 

	head = NULL;
	do{
		system("cls");
		printf("================MENU UTAMA==================\n");
		printf("Masukkan Apa Yang Ingin Dilakukan\n");
		printf("1. Daftar Lagu\n");
		printf("2. Daftar Putar Lagu\n");
		printf("3. Memutar Lagu\n");
		printf("MASUKKAN PILIHAN (tekan q untuk logout) : ");
		fflush(stdin); scanf("%c", &pilih);
		if (pilih == '1'){
			head = NULL;
			do{
				system("cls");
				printf("---------MENU DAFTAR LAGU-----------------\n");
				printf("1. Tambah lagu diawal\n");
				printf("2. Tambah lagu ditengah daftar\n");
				printf("3. Tambah lagu diakhir\n");
				printf("4. Hapus lagu diawal\n");
				printf("5. Hapus lagu ditengah daftar\n");
				printf("6. Hapus lagu diakhir\n");
				printf("7. Total jumlah lagu\n");
				printf("8. Mencari lagu didalam daftar\n");
				printf("9. cetak isi daftar lagu\n");
				printf("MASUKKAN PILIHAN (tekan q untuk logout) : ");
				fflush(stdin); scanf("%c", &pilih);
				if (pilih == '1')
					tambahAwal(&head);
				else if (pilih == '2')
					tambahData(&head);
				/*else if (pilih == '3')
					tambahAkhir(&head);
				else if (pilih == '4')
					hapusAwal(&head);
				else if (pilih == '5')
					hapusData(&head);
				else if (pilih == '6')
					hapusAkhir(&head);
				else if (pilih == '7')
					totalData(&head);
				else if (pilih == '8')
					cariData(&head);
				else if (pilih == '9'){
					tranverse(head);
				    getch();
				}*/ else {
                    printf("\nInvalid Choice\n");
                }
			} while (pilih != 'q');
        } else {
                printf("\nInvalid Choice\n");
            }
        } while (pilih != 'q');
  
	return 0;
}
//================================================================
//===================DOUBLE LINKED LIST=============================
// Fungsi untuk menambahkan data di awal linked list
void tambahAwal(node **head) {
    node *pNew = (node *)malloc(sizeof(node));
    
    printf("Masukkan ID Lagu: ");
    scanf("%d", &pNew->id);
    getchar();
    
    printf("Masukkan Judul Lagu: ");
    fgets(pNew->judul, sizeof(pNew->judul), stdin);
    pNew->judul[strcspn(pNew->judul, "\n")] = 0;  // Menghilangkan newline
    
    printf("Masukkan Nama Artis: ");
    fgets(pNew->artis, sizeof(pNew->artis), stdin);
    pNew->artis[strcspn(pNew->artis, "\n")] = 0;

    printf("Masukkan Durasi Lagu (dalam detik): ");
    scanf("%d", &pNew->durasi);
    
    printf("Masukkan Tahun Rilis: ");
    scanf("%d", &pNew->tahunRilis);
    
    pNew->right = *head;
    pNew->left = NULL;
    if (*head != NULL) {
        (*head)->left = pNew;
    }
    *head = pNew;
}

// Fungsi untuk menambahkan data di posisi tertentu dalam linked list
void tambahData(node **head) {
    int pos, count = 1;
    node *pCur = *head;
    node *pNew = (node *)malloc(sizeof(node));
    
    printf("Masukkan posisi untuk menambah data lagu: ");
    scanf("%d", &pos);
    
    printf("Masukkan ID Lagu: ");
    scanf("%d", &pNew->id);
    getchar();
    
    printf("Masukkan Judul Lagu: ");
    fgets(pNew->judul, sizeof(pNew->judul), stdin);
    pNew->judul[strcspn(pNew->judul, "\n")] = 0;
    
    printf("Masukkan Nama Artis: ");
    fgets(pNew->artis, sizeof(pNew->artis), stdin);
    pNew->artis[strcspn(pNew->artis, "\n")] = 0;

    printf("Masukkan Durasi Lagu (dalam detik): ");
    scanf("%d", &pNew->durasi);
    
    printf("Masukkan Tahun Rilis: ");
    scanf("%d", &pNew->tahunRilis);

    pNew->right = NULL;
    pNew->left = NULL;

    if (pos == 1) {
        pNew->right = *head;
        if (*head != NULL) {
            (*head)->left = pNew;
        }
        *head = pNew;
        return;
    }
    while (pCur != NULL && count < pos - 1) {
        pCur = pCur->right;
        count++;
    }
    if (pCur == NULL) {
        printf("Posisi tidak valid, menambah data lagu di akhir.\n");
        while (pCur->right != NULL) {
            pCur = pCur->right;
        }
        pCur->right = pNew;
        pNew->left = pCur;
    } else {
        pNew->right = pCur->right;
        pCur->right = pNew;
        pNew->left = pCur;
        if (pNew->right != NULL) {
            pNew->right->left = pNew;
        }
    }
}
